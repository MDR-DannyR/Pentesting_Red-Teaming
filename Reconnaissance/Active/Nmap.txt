<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Nmap</title>
</head><body><b><u>Nmap<br/>
<br/>
</u>Info <br/>
<br/>
</b>Port scanning tool &amp; many tools for version checking, scripts to run etc.<br/>
<br/>
<b><u>Commands</u></b><br/>
<br/>
<b>A default nmap TCP scan will scan the 1000 most popular ports on a given machine.</b><br/>
<br/>
root@kali:~# nmap -sT 10.0.0.19<br/>
<br/>
<b>Full TCP scan</b><br/>
<br/>
nmap -sT -p 1-65535 10.0.0.19<br/>
<br/>
<b>Network Sweep<br/>
<br/>
</b>root@kali:~# nmap -sn 10.11.1.1-254<br/>
<br/>
<b>Network Sweep with greppable output</b><br/>
<br/>
root@kali:~# nmap -v -sn 10.11.1.1-254 -oG ping-sweep.txt<br/>
<br/>
<b>Network Sweep for a specific Port</b><br/>
<br/>
root@kali:~# nmap -p 80 10.11.1.1-254 -oG web-sweep.txt<br/>
<br/>
<b>Top 20 TCP ports scan<br/>
<br/>
</b>root@kali:~# nmap –sT –A --top-ports=20 10.11.1.1-254 –oG top-port-sweep.txt<br/>
<br/>
<b>OS fingerprinting<br/>
<br/>
</b>root@kali:~# nmap -O 10.0.0.19<br/>
<br/>
<b>Banner Grabbing - Identify Services on ports (-A and -sV)</b><br/>
<br/>
root@kali:~# nmap -sV -sT 10.0.0.19<br/>
<br/>
<b>NSE - Nmap Scripting Engine</b><br/>
<br/>
<b>Info</b>: found at /usr/share/nmap/scripts<br/>
root@kali:~# nmap 10.0.0.19 --script smb-os-discovery.nse<br/>
<br/>
<br/>
<b><u>Appendix - Common Options</u><br/>
<br/>
</b><b>TARGET SPECIFICATION:</b><br/>
&nbsp; Can pass hostnames, IP addresses, networks, etc.<br/>
&nbsp; Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254<br/>
&nbsp; -iL &lt;inputfilename&gt;: Input from list of hosts/networks<br/>
&nbsp; -iR &lt;num hosts&gt;: Choose random targets<br/>
&nbsp; --exclude &lt;host1[,host2][,host3],...&gt;: Exclude hosts/networks<br/>
&nbsp; --excludefile &lt;exclude_file&gt;: Exclude list from file<br/>
<b>HOST DISCOVERY:</b><br/>
&nbsp; -sL: List Scan - simply list targets to scan<br/>
&nbsp; -sn: Ping Scan - disable port scan<br/>
&nbsp; -Pn: Treat all hosts as online -- skip host discovery<br/>
&nbsp; -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports<br/>
&nbsp; -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes<br/>
&nbsp; -PO[protocol list]: IP Protocol Ping<br/>
&nbsp; -n/-R: Never do DNS resolution/Always resolve [default: sometimes]<br/>
&nbsp; --dns-servers &lt;serv1[,serv2],...&gt;: Specify custom DNS servers<br/>
&nbsp; --system-dns: Use OS's DNS resolver<br/>
&nbsp; --traceroute: Trace hop path to each host<br/>
<b>SCAN TECHNIQUES:</b><br/>
&nbsp; -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans<br/>
&nbsp; -sU: UDP Scan<br/>
&nbsp; -sN/sF/sX: TCP Null, FIN, and Xmas scans<br/>
&nbsp; --scanflags &lt;flags&gt;: Customize TCP scan flags<br/>
&nbsp; -sI &lt;zombie host[:probeport]&gt;: Idle scan<br/>
&nbsp; -sY/sZ: SCTP INIT/COOKIE-ECHO scans<br/>
&nbsp; -sO: IP protocol scan<br/>
&nbsp; -b &lt;FTP relay host&gt;: FTP bounce scan<br/>
<b>PORT SPECIFICATION AND SCAN ORDER:</b><br/>
&nbsp; -p &lt;port ranges&gt;: Only scan specified ports<br/>
&nbsp; &nbsp; Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9<br/>
&nbsp; --exclude-ports &lt;port ranges&gt;: Exclude the specified ports from scanning<br/>
&nbsp; -F: Fast mode - Scan fewer ports than the default scan<br/>
&nbsp; -r: Scan ports consecutively - don't randomize<br/>
&nbsp; --top-ports &lt;number&gt;: Scan &lt;number&gt; most common ports<br/>
&nbsp; --port-ratio &lt;ratio&gt;: Scan ports more common than &lt;ratio&gt;<br/>
<b>SERVICE/VERSION DETECTION:</b><br/>
&nbsp; -sV: Probe open ports to determine service/version info<br/>
&nbsp; --version-intensity &lt;level&gt;: Set from 0 (light) to 9 (try all probes)<br/>
&nbsp; --version-light: Limit to most likely probes (intensity 2)<br/>
&nbsp; --version-all: Try every single probe (intensity 9)<br/>
&nbsp; --version-trace: Show detailed version scan activity (for debugging)<br/>
<b>SCRIPT SCAN:</b><br/>
&nbsp; -sC: equivalent to --script=default<br/>
&nbsp; --script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma separated list of<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;directories, script-files or script-categories<br/>
&nbsp; --script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments to scripts<br/>
&nbsp; --script-args-file=filename: provide NSE script args in a file<br/>
&nbsp; --script-trace: Show all data sent and received<br/>
&nbsp; --script-updatedb: Update the script database.<br/>
&nbsp; --script-help=&lt;Lua scripts&gt;: Show help about scripts.<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Lua scripts&gt; is a comma-separated list of script-files or<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;script-categories.<br/>
<b>OS DETECTION:</b><br/>
&nbsp; -O: Enable OS detection<br/>
&nbsp; --osscan-limit: Limit OS detection to promising targets<br/>
&nbsp; --osscan-guess: Guess OS more aggressively<br/>
<b>TIMING AND PERFORMANCE:</b><br/>
&nbsp; Options which take &lt;time&gt; are in seconds, or append 'ms' (milliseconds),<br/>
&nbsp; 's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).<br/>
&nbsp; -T&lt;0-5&gt;: Set timing template (higher is faster)<br/>
&nbsp; --min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host scan group sizes<br/>
&nbsp; --min-parallelism/max-parallelism &lt;numprobes&gt;: Probe parallelization<br/>
&nbsp; --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;time&gt;: Specifies<br/>
&nbsp; &nbsp; &nbsp; probe round trip time.<br/>
&nbsp; --max-retries &lt;tries&gt;: Caps number of port scan probe retransmissions.<br/>
&nbsp; --host-timeout &lt;time&gt;: Give up on target after this long<br/>
&nbsp; --scan-delay/--max-scan-delay &lt;time&gt;: Adjust delay between probes<br/>
&nbsp; --min-rate &lt;number&gt;: Send packets no slower than &lt;number&gt; per second<br/>
&nbsp; --max-rate &lt;number&gt;: Send packets no faster than &lt;number&gt; per second<br/>
<b>FIREWALL/IDS EVASION AND SPOOFING:</b><br/>
&nbsp; -f; --mtu &lt;val&gt;: fragment packets (optionally w/given MTU)<br/>
&nbsp; -D &lt;decoy1,decoy2[,ME],...&gt;: Cloak a scan with decoys<br/>
&nbsp; -S &lt;IP_Address&gt;: Spoof source address<br/>
&nbsp; -e &lt;iface&gt;: Use specified interface<br/>
&nbsp; -g/--source-port &lt;portnum&gt;: Use given port number<br/>
&nbsp; --proxies &lt;url1,[url2],...&gt;: Relay connections through HTTP/SOCKS4 proxies<br/>
&nbsp; --data &lt;hex string&gt;: Append a custom payload to sent packets<br/>
&nbsp; --data-string &lt;string&gt;: Append a custom ASCII string to sent packets<br/>
&nbsp; --data-length &lt;num&gt;: Append random data to sent packets<br/>
&nbsp; --ip-options &lt;options&gt;: Send packets with specified ip options<br/>
&nbsp; --ttl &lt;val&gt;: Set IP time-to-live field<br/>
&nbsp; --spoof-mac &lt;mac address/prefix/vendor name&gt;: Spoof your MAC address<br/>
&nbsp; --badsum: Send packets with a bogus TCP/UDP/SCTP checksum<br/>
<b>OUTPUT:</b><br/>
&nbsp; -oN/-oX/-oS/-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,<br/>
&nbsp; &nbsp; &nbsp;and Grepable format, respectively, to the given filename.<br/>
&nbsp; -oA &lt;basename&gt;: Output in the three major formats at once<br/>
&nbsp; -v: Increase verbosity level (use -vv or more for greater effect)<br/>
&nbsp; -d: Increase debugging level (use -dd or more for greater effect)<br/>
&nbsp; --reason: Display the reason a port is in a particular state<br/>
&nbsp; --open: Only show open (or possibly open) ports<br/>
&nbsp; --packet-trace: Show all packets sent and received<br/>
&nbsp; --iflist: Print host interfaces and routes (for debugging)<br/>
&nbsp; --append-output: Append to rather than clobber specified output files<br/>
&nbsp; --resume &lt;filename&gt;: Resume an aborted scan<br/>
&nbsp; --stylesheet &lt;path/URL&gt;: XSL stylesheet to transform XML output to HTML<br/>
&nbsp; --webxml: Reference stylesheet from Nmap.Org for more portable XML<br/>
&nbsp; --no-stylesheet: Prevent associating of XSL stylesheet w/XML output<br/>
<b>MISC:</b><br/>
&nbsp; -6: Enable IPv6 scanning<br/>
&nbsp; -A: Enable OS detection, version detection, script scanning, and traceroute<br/>
&nbsp; --datadir &lt;dirname&gt;: Specify custom Nmap data file location<br/>
&nbsp; --send-eth/--send-ip: Send using raw ethernet frames or IP packets<br/>
&nbsp; --privileged: Assume that the user is fully privileged<br/>
&nbsp; --unprivileged: Assume the user lacks raw socket privileges<br/>
&nbsp; -V: Print version number<br/>
&nbsp; -h: Print this help summary page.<br/>
<br/>
<br/>
</body></html>