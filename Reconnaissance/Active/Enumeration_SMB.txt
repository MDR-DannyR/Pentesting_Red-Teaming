<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SMB Enumeration</title>
</head><body><b><u>SMB Enumeration<br/>
<br/>
</u>Info <br/>
<br/>
</b>Server Message Block (SMB)<br/>
<br/>
o SMB1 – Windows 2000, XP and Windows 2003. <br/>
o SMB2 – Windows Vista SP1 and Windows 2008 <br/>
o SMB2.1 – Windows 7 and Windows 2008 R2<br/>
o SMB3 – Windows 8 and Windows 2012.<br/>
<br/>
The SMB NetBIOS service listens on TCP ports 139 and 445, as well as several UDP ports.<br/>
<br/>
A Null Session<b>&nbsp;</b>refers to an unauthenticated NetBIOS session between two computers.<br/>
<br/>
<b><u>Commands</u><br/>
<br/>
Scan for open ports using nmap<br/>
</b><br/>
root@kali:~# nmap -v -p 139,445 -oG smb.txt 10.11.1.1-254<br/>
<br/>
<b><u>nbtscan</u><br/>
<br/>
</b><b>Info:</b>&nbsp;Tool for specifically identifying NetBIOS information<br/>
<br/>
<b>Command:</b>&nbsp;root@kali:~# nbtscan -r 10.11.1.0/24<br/>
<br/>
<br/>
<b><u>Enum4linux</u><br/>
<br/>
Info: <br/>
<br/>
</b>enum4linux is a tool for enumerating information from Windows and Samba systems. It is written in Perl and is basically a wrapper around the Samba tools smbclient, rpcclient, net and nmblookup.<br/>
<br/>
<br/>
<b>Command for a NetBIOS null session:<br/>
</b><br/>
root@kali:~# enum4linux -a 10.11.1.227<br/>
<br/>
<b><u><br/>
Nmap SMB scripts<br/>
<br/>
</u>Command<br/>
<br/>
</b>root@kali:~# ls -l /usr/share/nmap/scripts/smb*<br/>
<br/>
root@kali:~# nmap -v -p 139, 445 --script=smb-os-discovery 10.11.1.227<br/>
<br/>
root@kali:~# nmap -v -p 139,445 --script=smb-vuln-ms08-067 --script-args=unsafe=1 10.11.1.201<br/>
<br/>
<br/>
<br/>
<u><b><br/>
<br/>
<br/>
<br/>
</b></u></body></html>