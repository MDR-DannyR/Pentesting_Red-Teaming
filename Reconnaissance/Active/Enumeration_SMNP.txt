SMNP Enumeration

Info 

Simple Network Management Protocol. Used to manage a network.

Port TCP 161

SNMP is based on UDP, a simple, stateless protocol, and is therefore susceptible to IP spoofing, and replay attacks. 
In addition, the commonly used SNMP protocols 1, 2, and 2c offer no traffic encryption, meaning SNMP information and credentials can be easily intercepted over a local network. 
Traditional SNMP protocols also have weak authentication schemes, and are commonly left configured with default public and private community strings.

The SNMP Management Information Base (MIB) is a database containing information usually related to network management. 
The database is organized like a tree, where branches represent different organizations or network functions. 
The leaves of the tree (final endpoints) correspond to specific variable values that can then be accessed, and probed, by an external user.
o http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm. aix.progcomm/doc/progcomc/mib.htm


MIB values corresponding to specific Microsoft Windows SNMP parameters:

1.3.6.1.2.1.25.1.6.0 -----System Processes
 
1.3.6.1.2.1.25.4.2.1.2 ---Running Programs
 
1.3.6.1.2.1.25.4.2.1.4 ---Processes Path
 
1.3.6.1.2.1.25.2.3.1.4 ---Storage Units
 
1.3.6.1.2.1.25.6.3.1.2 ---Software Name
 
1.3.6.1.4.1.77.1.2.25 ----User Accounts
 
1.3.6.1.2.1.6.13.1.3 ------TCP Local Ports


Nmap scan for open SNMP ports

root@kali:~# nmap -sU --open -p 161 10.11.1.1-254 -oG mega-snmp.txt


onesixtyone

Info: Check for given community strings against an IP list. Allows brute force of various community strings.

Commands:

root@kali:~# echo public > community
root@kali:~# echo private >> community
root@kali:~# echo manager >> community
root@kali:~# for ip in $(seq 200 254);do echo 10.11.1.$ip;done > ips root@kali:~# onesixtyone -c community -i ips
 

snmpwalk

Info: provided the SNMP read-only community string (default = public), we can probe and query SNMP values. 


Windows SNMP Enumeration example:

Enumerating the Entire MIB Tree:

root@kali:~# snmpwalk -c public -v1 10.11.1.219

Enumerating Windows Users:

root@kali:~# snmpwalk –c public –v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25

Enumerating Running Windows Processes:

root@kali:~# snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.4.2.1.2

Enumerating Open TCP Ports:

root@kali:~# snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.6.13.1.3

Enumerating Installed Software:

root@kali:~# snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.6.3.1.2



snmpcheck

Info: SMNP service enumeration tool

Commands

root@kali:~# snmp-check -h

root@kali:~# snmp-check -t 192.168.1.2 -c public








