Password Attacks - Pwdump and Fgdump

Info:  
Used on Windows Operating Systems. 

MS operating systems store hashed password in the Security Accounts Manager (SAM). 
To deter offline password attacks, MS introduced the SKSKEY feature (Windows NT 4.0 SP3) which partially encrypts the SAM file. 

Windows NT-based operating systems, up through and including Windows 2003, store two different password hashes:
	•	LAN Manager (LM) - based on DES 
	•	NT LAN Manager (NTLM) - based on MD4 hashing. 
	•	
Windows Vista onwards, LM is disabled by default and uses NTLM.
	•	
LM is weak for reasons:
	•	Passwords longer than 7 characters are split into two strings and each piece is hashed seperately
	•	Password is converted to Upper Case before being hashed
	•	Does not include salts, making rainbow table attacks feasible. 
	•	 
NTLM is:
	•	Case sensitive
	•	supports all unicode characters
	•	Does not limit stored passwords to two 7 character parts
	•	Not salted.
	•	
SAM database cannot be coped with Operating system is running, as kernel keep an exclusive file system lock on the file. However, In memory attacks to dump the SAM hashes can be mounted. 


Fgdump and pwdump

Info: 
Perform in-memory attacks, as they inject a DLL containing the hash dumping code in the Local Security Authrotiy Subsystem (LSASS) process. 
LSASS process has the necessary privileges to extract password hases as well as many useful API that can be used by the hash dumping tool. 

Fgump works in a very similar manner to pwdump, however it also attempts to kill local anti-viruses before attempting to dump the password hashes and cached credentials. 

C:\>fgdump.exe

C:\>type 127.0.0.1.pwdump



Windows Credential Editor (WCE)

Info:

Tool to obtain clear text passwords and hases from a compromised windows host. 
Steal NTLM credentials from memory
dump cleartext password stored by windows authentication packages installed on the system such as msv1_0.dll, kerberos.dll and digest.dll. 
Able to steal credentials either by using DLL injection or by directly reading the LSASS process memory. (LSASS process memory method is more secure in terms of OS stability as it does not inject code into a highly privileged process)

C:\>wce.exe











