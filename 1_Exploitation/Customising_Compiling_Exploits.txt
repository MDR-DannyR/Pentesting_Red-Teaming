Customizing Exploits


Inspect the Exploits directives:

root@kali:~/slmail# head 643.c 


Command output (example of Unix like environment with a compiler such as gcc)

#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/socket.h> 
#include <sys/types.h> 
#include <sys/wait.h> 
#include <errno.h> 
#include <netinet/in.h> 
#include <netdb.h> 
#include <string.h>

Command output (example of Windows like environment with a compiler such as mingw)

#include <string.h>
#include <stdio.h>
#include <winsock2.h>
#include <windows.h>

Issues to look for:

Wrong shellcode
Wrong type of shell - i.e. bind shelll
Harcoded IP's / Ports
Buffer sizes changing may cause misalignment of various instructions in exploit


Compile exploit:

mingw cross compiler to compile this code into a Windows PE executable, and then run this executable on Kali Linux using wine.


root@kali:~/slmail# i686-w64-mingw32-gcc 646-fixed.c -lws2_32 -o 646.exe

root@kali:~/slmail# wine 646.exe 10.11.1.35





