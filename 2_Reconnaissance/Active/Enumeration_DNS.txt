DNS Enumeration

Info 

DNS offers a variety of information about public (and sometimes private!) organization servers, such as IP addresses, server names, and server functionality.
A DNS server will usually divulge DNS and mail server information for the domain it has authority over. This is a necessity, as public requests for mail and DNS server addresses make up the basic Internet experience


Discover the DNS and Mail Servers For A Domain

root@kali:~# host -t ns megacorpone.com

root@kali:~# host -t mx megacorpone.com

Download DNS records: 

root@kali:~# host -l [URL] [Name server address]

Note: ns = name server; mx = mail exchange



Forward Lookup Brute Force

Info: Guess valid names of servers by attempting to resolve a given name

Command to check One server: root@kali:~# host www.megacorpone.com

Command to check multiple servers: root@kali:~# for ip in $(cat list.txt);do host $ip.megacorpone.com;done 

Note: list contains ftp;mail;owa;proxy;router. i.e hostnames.


Reverse Lookup Brute Force

Info: Guess valid names of servers by attempting to resolve an ip address

Command to check multiple servers: root@kali:~# for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v "not found"


Zone Transfer

Info: Zone transfer is the process of copying the zone file from a master DNS server to a slave server. The zone file contains a list of all the DNS names configured for that zone. 

Command to check One server format: host -l <domain name> <dns server address>

Command to check One server: root@kali:~# host -l megacorpone.com ns1.megacorpone.com

Automated Command: 

#/bin/bash
# Simple Zone Transfer Bash Script
# $1 is the first argument given after the bash script # Check if argument was given, if not, print usage
if [ -z "$1" ]; then
echo "[*] Simple Zone transfer script"
echo "[*] Usage : $0 <domain name> "
exit 0
fi
# if argument was given, identify the DNS servers for the domain
for server in $(host -t ns $1 |cut -d" " -f4);do
# For each of these servers, attempt a zone transfer
host -l $1 $server |grep "has address" done

Run Automated Command

root@kali:~# chmod 755 dns-axfr.sh
root@kali:~# ./dns-axfr.sh megacorpone.com


DNSRecon

Info: DNSRecon is an advanced, modern DNS enumeration script written in Python.

Test NS servers for zone transer and attempt it on all NS servers:

root@kali:~# dnsrecon -d megacorpone.com -t axfr


DNSEnum

Info: DNS Enumeration tool

Test Domain and get all MX and NS servers. Then attempt Zone Transfer

root@kali:~# dnsrecon -d megacorpone.com -t axfr


