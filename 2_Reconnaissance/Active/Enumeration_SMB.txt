SMB Enumeration

Info 

Server Message Block (SMB)

o SMB1 – Windows 2000, XP and Windows 2003. 
o SMB2 – Windows Vista SP1 and Windows 2008 
o SMB2.1 – Windows 7 and Windows 2008 R2
o SMB3 – Windows 8 and Windows 2012.

The SMB NetBIOS service listens on TCP ports 139 and 445, as well as several UDP ports.

A Null Session refers to an unauthenticated NetBIOS session between two computers.

Commands

Scan for open ports using nmap

root@kali:~# nmap -v -p 139,445 -oG smb.txt 10.11.1.1-254

nbtscan

Info: Tool for specifically identifying NetBIOS information

Command: root@kali:~# nbtscan -r 10.11.1.0/24


Enum4linux

Info: 

enum4linux is a tool for enumerating information from Windows and Samba systems. It is written in Perl and is basically a wrapper around the Samba tools smbclient, rpcclient, net and nmblookup.


Command for a NetBIOS null session:

root@kali:~# enum4linux -a 10.11.1.227


Nmap SMB scripts

Command

root@kali:~# ls -l /usr/share/nmap/scripts/smb*

root@kali:~# nmap -v -p 139, 445 --script=smb-os-discovery 10.11.1.227

root@kali:~# nmap -v -p 139,445 --script=smb-vuln-ms08-067 --script-args=unsafe=1 10.11.1.201







