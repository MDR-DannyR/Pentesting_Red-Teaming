# Utility Commands

| Command         | Description                                   |
| --------------- | --------------------------------------------- |
| tasklist /S ip /v   | Remote process listing            |
| systeminfo /S ip /U domain\user /P Pwd   | Remote systeminfo            |
| net share \\ ip   | Shares of remote computer            |
| net use \\ ip   | Remote filesystem (IPC$)            |
| net use z: \\ ip \share password /user: DOMAIN\user   | Map drive with specified credentials            |
| reg add \\ ip \ regkey \ value   | Add registry key remotely            |
| sc \\ ip create service binpath=C:\Windows\System32\x.exe start= auto  | Create a remote service (Space after start=)            |
| xcopy /s \\ ip \dir C:\local   | Copy remote folder            |
| shutdown /m \\ ip /r /t 0 /f   | Remotely reboot machine            |
| type file   | Display file contents            |
| del path \'.' /a /s /q /f   | Forceably delete all files in path            |
| find /I "str" filename   | Find "str"            |
| command &#124; find /c /v ""   | Line count of cmd output            |
| at HH:MM file [args] | Schedule file to run   (i.e. at 14:45 cmd /c)         |
| runas /user: user " file [args] "   | Run file as user            |
| restart /r /t 0   | Restart now            |
| tr -d '\15\32' win.txt unix.txt   | Removes CR & Z (*nix)            |
| makecab file   | Native compression            |
| Wusa.exe /uninstall /kb: ###   | Uninstall patch            |
| cmd.exe "wevtutil qe Application /c:40 /f:text /rd:true"   | CLI Event Viewer            |
| lusrmgr.msc   | Local user manager            |
| services.msc   | Services control panel            |
| taskmgr.exe   | Task manager            |
| secpool.msc   | Security policy manager            |
| eventvwr.rnsc   | Event viewer            |
| rundll32.dll user32.dll LockWorkstation   | LoCK WORKSTATION            |
| netsh advfirewall set currentprofile state off <br> netsh advfirewall set allprofiles state off   | DISABLE WINDOWS FIREWALL    |
| netsh interface portproxy add v4tov4 listenport=3000 listenaddress=1.1.1.1 connectport=4000 connectaddress=2.2.2.2 | NATIVE WINDOWS PORT FORWARD ( MUST BE ADMIN)        |
| netsh interface portproxy delete v4tov4 listenport=3000 listenaddress=1.1.1.1   | REMOVE PORT FORWARD (Must be admin)            |
| reg add HKCU\Software\Policies\Microsoft\Windows\System /v DisableCMD /t REG_DWORD /d 0 /f   | RE-ENABLE COMMAND PROMPT        |
| psexec /accepteula \\ targetiP -u domain\user -p password -c -f \\ smbIP \share\file.exe   | EXECUTE FILE HOSTED ON REMOTE SYSTEM WITH SPECIFIED CREDENTIALS            |
| psexec /accepteula \\ ip -u Domain\user -p LM : NTLM cmd.exe /c dir c:\Progra-1   | RUN REMOTE COMMAND WITH SPECIFIED HASH    |
| psexec /accepteula \\ ip -s cmd.exe   | RUN REMOTE COMMAND AS SYSTEM            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
| port   | Netcat            |
