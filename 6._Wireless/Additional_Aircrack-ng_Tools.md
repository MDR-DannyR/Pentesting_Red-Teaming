# Additional Aircrack-ng Tools 

## Airdecap-ng 

Once the key has been retrieved to a wireless network, airdecap-ng can be used to decrypt WEP, WPA or WPA2 capture files. It can also be used to strip the wireless headers from an unencrypted wireless capture. 


### Usage 

```
airdecap-ng [options] <capture> 
```

Option      Param     Description
-l                    Donâ€™t remove the 802.11 header
-b          bssid     AP MAC address filter
-k          pmk       WPA/WPA2 PMK in hex
-e          essid     Target network ESSID
-p          pass      Target network WPA passphrase
-w          key       Target network WEP key in hex

### Removing wireless headers from unencrypted capture 

This leaves us with just the data packets (output file will be same as original with -dec appended)

```
airedecap-ng -b <AP MAC> <capture>
```

### Removing wireless headers and unecrypting WEP capture

```
airdecap-ng -w <WEP key> -b <AP MAC> <capture>
```

### Removing wireless headers and unencrypting WPA/WPA2 capture 

```
airdecap-ng -e <ESSID> -p <WPA Password> -b <AP MAC> <capture>
```


## Airsev-ng 

Wireless card server that allows multiple wireless applications to use a wireless card via a client-server TCP connection

### Usage 

```
airserv-ng <options>
```

Where:
-p <port>: TCP port to listen on. Defaults to 666
-d <dev>: wifi device to serve on the network
-c <chan>: channel number to start the server on
-v <level>: debug level

The wireless card still needs to be in monitor mode to run airserv-ng. Furthermore, when starting the monitor interface, it is best not to specify a channel so that the remote client can choose. 

```
airmon-ng start wlan0
airserv-ng -p <port> -d mon0 
```

On the client you can now connect to the airserv-ng server:

```
airodump-ng -c 3 --bssid <AP MAC> <airserv-ng IP Address>:<port>
```


# Airtun-ng 

Virtual tunnel interface creator to allow all encrypted traffic to be monitored for wireless Intrusion Detection System (wIDS) purposes and can inject arbitary traffic into a network. 

For WIDS functionality, the encryption key and BSSID of the target network myst be known. Airtun-ng will then decrypt the traffic and can then pass it on to a traditional IDS such as snort. 

### Usage 

```
airtun-ng <options> <interface>
```

where the options are: 

Option        Param       Description
-x            nbpps       Maximum number of packets per second (optional)
-a            bssid       AP MAC address (mandatory)
-i            iface       Capture interface (optional)
-y            file        PRGA filename (optional but either -y or -w must be defined)
-w            wepkey      WEP key (optional but either -y or -w must be defined)
-t            tods        Send frames to AP (1) or client (0) (optional - defaults to 0)
-r            file        Read frames from a pcap file (optional)

and the repeater options are: 

Option        Param       Description
--repeat                  Activates repeat mode
 --bssid      <mac>       BSSID to repeat
--netmask     <mask>      Netmask for BSSID filter

### wIDS setup

card must be in monitor mode before running airtun-ng

```
airtun-ng -a <AP MAC> -w <WEP key> <interface>
```

Bring up the interface that airtun-ng has created. This will recieve a copy of every wireless network packet and the packets will be decrypted in real-time with the provided WEP key. 

```
ifconfig at0 up
```


### Wep injection setup 


card must be in monitor mode before running airtun-ng

```
airtun-ng -a <AP MAC> -w <WEP key> <interface>
```

Bring up the interface that airtun-ng has created with a specific IP address. Now any traffic sent to this interface will be sent on the wireless network. 

```
ifconfig at0 up 192.168.1.5/24
```

### PGRA injection setup

The PGRA attack allows injection of packets to the network without actually having the WEP key. Importantly, traffic that is recieved will not be decrypted. 

launch airtun-ng with the PRGA file. 

```
airtun-ng -a <AP MAC> -y <PRGA filename> <interface>
ifconfig at0 up 192.168.1.5/24
```













