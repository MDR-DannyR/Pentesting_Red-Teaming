# Using the Aircrack Suite 

## Airmon-ng 

Airmon-ng is a script that is used to enable and disable monitor mode on wireless interfaces

### Basics 

Display current wireless interface status 

```
airmon-ng 
```

Usage: 

```
airmon-ng <start|stop> <interface name> [channel]
airmon-ng <check|check kill>
```

<check|check kill> ‘check’ will display any processes that might interfere with the Aircrack-ng suite. ‘check kill’ will check for any processes and kill them off.


### Setting up 

Put card into monitor mode - this will create mon0 
```
airmon-ng start wlan0
```

Stop and remove the monitor interface 
```
airmon-ng stop mon0
```

Put the card into monitor mode on a specific channel 
```
airmon-ng start wlan0 3
```

Verify which channel the monitor interface is listening on 
```
iwlist mon0 channel 
```

## Airodump-ng 

Airodump-ng is used for the packet capture of raw 802.11 frames. In order to run airodump-ng, the wireless card needs to be in monitor mode. 

### Basic Usage 

```
airodump-ng <options> <interface name>[,<interface name>,...]
```

Where a sample of the options are: 

```
-w <prefix>     Saves the capture dump to the specified filename
--bssid <bssid> Filters Airodump-ng to only capture the specified BSSID
-c <channel>    Forces Airodump-ng to only capture the specified channel
```

Run a basic sniffing session: 

```
airodump-ng <interface name>
```

### Airodump fields 

Top portion is information about access points that have been detected. 
Bottom portion BSSID is the MAC address of the detected access points and STATION is the MAC address of the connected clients. 

### Precise sniffing 

Start the device in monitor mode on channel 3. Then using airodump, capture only on channel 3, with the Base Station ID set, write it out to file cap1 and do this all on interface mon0. 
``` 
airmon-ng start wlan0 3
airodump-ng -c <Channel> --bssid <BSSID> -w <Capture> <interface name> 
airodump-ng -c 3 --bssid 34:08:04:09:3D:38 -w cap1 mon0
```

If sniffing for WEP, use the --ivs option which will only store weak initialisation vectors and not the full packet. 
If sniffing for WPA/WPA2 or carrying out a PTW attack against WEP then make sure you do not set the --ivs flag. 

```
airodump-ng -c <Channel> --bssid <BSSID> -w <Capture> --ivs <interface name>
```


## Aireplay-ng 

Aireplay-ng is primarily used to generate or accelerate wireless traffic for the later use with Aircrack-ng to crack WEP and WPA-PSK keys.

### Basic Usage  

Aireplay supports the following attacks: 

```
Attack # (flags)          Attack Name                              Description
-0 --deauth acount        Deauthentication                         De-authenticate 1 or all stations
-1 --fakeauthdelay        Fake Authentication                      Fake authentication with the AP
-2 --interactive          Interactive Packet Replay                Interactive frame selection
-3 --arpreplay            ARP Request Replay Attack                Standard ARP request replay
-4 --chopchop             KoreK ChopChop Attack                    Decrypt/chopchop WEP packet
-5 --fragment             Fragmentation Attack                     Generates a valid keystream
-6 --caffe-latte          Café-Latte Attack                        Query a client for new IVs
-7 --cfrag                Client-Oriented Fragmentation Attack     Fragments against a client
-8 --migmode              MigMode                                  Attacks WPA migration mode
-9 --test                 Injection Test                           Tests injection and quality
```

```
aireplay-ng <options> <interface name>
```

Filters can be used for all attacks apart from deauthentication and fake authentication. 

```
Option          Description
-b bssid        MAC address, Access Point 
-d dmac         MAC address, Destination
-s smac         MAC address, Source
-m len          Minimum Packet Length
-n len          Maximum Packet Length
-u type         Frame control, type field
-v subt         Frame control, subtype field
-f fromds       Frame control, From DS bit
-w iswep        Frame control, WEP bit
```

For replay attacks (i.e. injection attacks) the following options apply. 

```
Option          Description
-x nbpps        Number of packets per second
-p fctrl        Set frame control word (hex)
-a bssid        Access point MAC address
-c dmac         Destination MAC address
-h smac         Source MAC address
-e essid        Target AP SSID
-j              arpreplay attack: inject FromDS packets
-g value        Change ring buffer size (default: 8) 
-k IP           Destination IP in fragments
-l IP           Source IP in fragments
-o npckts       Number of packets per burst (-1)
-q sec          Seconds between keep-alives (-1) 
-y prga         Keystream for shared key authentication
-B              Bit rate test
-D              Disable AP detection
-F              Chooses first matching packet
-R              Disables /dev/rtc usage
```

For Source attacks (where aireplayy-ng obtain packets from two sources (i.e. a live flow from wireless card and a pre-captured pcap file, the following options apply: 

```
Option          Description
-i iface        Capture packets from the interface 
-r file         Extract packets from a file
```





