SSH Local Port Forwarding

Info: Tunnel a local port to a remote server using SSH. 

Program: SSH

Set Up:

On Machine B run the ssh daemon on port 53:

root@kali:~# /etc/ssh/sshd_config

# What ports, IPs and protocols we listen for
Port 53

root@kali:~# /etc/init.d/ssh restart


On Machine A run the ssh command:

ssh <gateway> -L <local port to listen>:<remote host>:<remote port>

ssh w.x.y.z -L 8080:a.b.c.d:80 -p 53

Note: 

Gateway = Machine B ip address
-L = Local Port Forwarding
local port to listen = Machine A's port that the traffic will have to be directed to
remote host = Machine C ip address 
remote port = Machine C port
-p = Port of Machine B SSH server


Run: 

On Machine A browse to http://127.0.0.1:8080


Usage

Situation: Machine A cannot connect to the Webserver on Machine C due to its firewall only allowing outbound traffic on TCP port 53.

Victim's machine Attacker's Machine Web server hosting files
	•	
Machine A <----------------> Machine B <---------------------------------------------> Machine C

Machine A <-------------------> w.y.x.z <-------------------------------------------------> a.b.c.d:80


Machine B sets up SSH daemon on port 53
Machine A SSH connects to Machine B on port 53 using the local port fowarding method, setting the gateway as Machine B, the local port as 8080, the remote host as Machine C, and the port as 80 (web server)
Machine A browses to 127.0.0.1:8080 which sends the traffic through the SSH tunnel, to Machine B, which sends the traffic onto the web server on Machine C. 





